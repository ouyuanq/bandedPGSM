(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53676,       1271]
NotebookOptionsPosition[     52105,       1240]
NotebookOutlinePosition[     52494,       1257]
CellTagsIndexPosition[     52451,       1254]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "BasisRecombinationCoeffs", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisRecombinationCoeffs", "[", 
    RowBox[{
    "lbc_List", ",", "rbc_List", ",", "lrbc_Integer", ",", "lrbccoeffs_List", 
     ",", "rrbc_Integer", ",", "rrbccoeffs_List", ",", "mbc_Integer", ",", 
     "intbc_Integer", ",", "basis_"}], " ", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "M", ",", "gamma", ",", "eqs", ",", "eqs2", ",", "leftsign", ",", "eql",
        ",", "eqr", ",", "eqlr", ",", "eqrr", ",", "eqm", ",", "eqm2", ",", 
       "midsign", ",", "eqint", ",", "eqint2", ",", "sol", ",", "sol2", ",", 
       "bc", ",", "bcm", ",", "bcint", ",", "alpha"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"The", " ", "order", " ", "of", " ", "the", " ", 
       RowBox[{"ODE", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{
        RowBox[{"Length", "[", "lbc", "]"}], "+", 
        RowBox[{"Length", "[", "rbc", "]"}], "+", "lrbc", "+", "rrbc", "+", 
        "mbc", "+", "intbc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Allocate", " ", "for", " ", "the", " ", "stencil", " ", "matrix", " ", 
        RowBox[{"gamma", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"gamma", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"\[Gamma]", ",", 
         RowBox[{"M", "+", "1"}], ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Initialize", " ", "an", " ", "empty", " ", "list", " ", "for", " ", 
        "the", " ", 
        RowBox[{"equations", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Define", " ", "bc"}], ",", "bcm", ",", 
        RowBox[{"bcint", " ", "based", " ", "on", " ", 
         RowBox[{"basis", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"basis", "===", "\"\<C\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Expression", " ", "for", " ", "the", " ", "values", " ", "of", " ",
            "Chebyshev", " ", "polynomials", " ", "at"}], "+", 
          RowBox[{
           RowBox[{"-", "1"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "up", " ", "to", " ", "a", " ", "scaling", " ", "factor"}], 
             ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
          RowBox[{"Fold", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"(", "#2", ")"}], "^", "2"}]}], ")"}]}], ")"}], 
             "&"}], ",", "1", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"y", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Expression", " ", "for", " ", "the", " ", "values", " ", "of", " ",
            "even", " ", "Chebyshev", " ", "polynomials", " ", "at", " ", 
           "0."}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcm", "[", "k_", "]"}], ":=", "1"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Expression", " ", "for", " ", "the", " ", "values", " ", "of", " ",
            "integral", " ", "of", " ", "Chebyshev", " ", "polynomials", " ", 
           RowBox[{
            RowBox[{"on", "[", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "]"}], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcint", "[", "k_", "]"}], "=", 
          RowBox[{"2", "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"k", "^", "2"}]}], ")"}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"basis", "===", "\"\<L\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Alternatives", " ", "for", " ", "Legendre", " ", 
          RowBox[{"polynomials", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
          RowBox[{"Fold", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#1", "*", 
               RowBox[{"(", 
                RowBox[{"x", "+", "1", "-", "#2"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{"x", "+", "#2"}], ")"}]}], ")"}], "&"}], ",", "1", 
            ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0", ",", 
              RowBox[{"y", "-", "1"}]}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcm", "[", "k_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "k", "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "k", ")"}], "!"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "/", "2"}], ")"}], "!"}], ")"}], "^", "2"}], 
               "*", 
               RowBox[{"2", "^", "k"}]}], ")"}]}], ",", "0"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcint", "[", "k_", "]"}], ":=", 
          RowBox[{"2", "*", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Sign", "[", "k", "]"}]}], ")"}]}]}], ";"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"basis", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<U\>\"", ",", 
            RowBox[{"_", "?", "NumericQ"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Alternatives", " ", "for", " ", "ultraspherical", " ", 
          RowBox[{"polynomials", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alpha", "=", 
          RowBox[{"Last", "[", "basis", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bc", "[", 
           RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
          RowBox[{
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#1", "*", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "#2"}], ")"}]}], ")"}], "&"}], ",", "1", 
             ",", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"2", "*", "alpha"}], "-", "1"}]}], "]"}]}], "]"}], 
           "*", 
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"#1", "*", 
                RowBox[{"(", 
                 RowBox[{"x", "+", "1", "-", "#2"}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{"x", "+", 
                  RowBox[{"2", "*", "alpha"}], "-", "1", "+", "#2"}], ")"}]}],
                ")"}], "&"}], ",", "1", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", 
               RowBox[{"y", "-", "1"}]}], "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcm", "[", "k_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "k", "]"}], ",", 
            RowBox[{
             RowBox[{"Gamma", "[", 
              RowBox[{
               RowBox[{"k", "/", "2"}], "+", "alpha"}], "]"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Gamma", "[", "alpha", "]"}], "*", 
               RowBox[{"Gamma", "[", 
                RowBox[{
                 RowBox[{"k", "/", "2"}], "+", "1"}], "]"}]}], ")"}]}], ",", 
            "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"bcint", "[", "k_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"k", "\[Equal]", "0"}], ",", 
            RowBox[{
             RowBox[{"2", "^", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "*", "alpha"}]}], ")"}]}], "*", 
             RowBox[{"Sqrt", "[", "Pi", "]"}], "*", 
             RowBox[{
              RowBox[{"Gamma", "[", 
               RowBox[{"alpha", "+", 
                RowBox[{"1", "/", "2"}]}], "]"}], "/", 
              RowBox[{"Gamma", "[", 
               RowBox[{"alpha", "+", "1"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", "alpha"}], "-", "1"}], ")"}], "*", 
               RowBox[{"Pochhammer", "[", 
                RowBox[{
                 RowBox[{"2", "*", "alpha"}], ",", "k"}], "]"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"k", "!"}], "*", 
               RowBox[{"(", 
                RowBox[{"k", "+", "1"}], ")"}], "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", "alpha"}], "+", "k", "-", "1"}], ")"}]}], 
              ")"}]}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Unsupported", " ", 
          RowBox[{"basis", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Unsupported basis.\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "$Failed", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Loop", " ", "each", " ", "boundary", " ", "condition", " ", "to", " ",
         "set", " ", "up", " ", 
        RowBox[{"equations", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Left", " ", "end", " ", 
        "point", " ", 
        RowBox[{"conditions", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "lbc", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"leftsign", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"eql", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"p", "=", "1"}], ",", 
           RowBox[{"p", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"leftsign", "=", 
             RowBox[{"-", "leftsign"}]}], ";", 
            RowBox[{"(*", 
             RowBox[{"alternating", " ", "sign"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"eql", "=", 
             RowBox[{"eql", "+", 
              RowBox[{"leftsign", "*", 
               RowBox[{"bc", "[", 
                RowBox[{
                 RowBox[{"k", "+", "p", "-", "1"}], ",", 
                 RowBox[{"lbc", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
               RowBox[{"gamma", "[", 
                RowBox[{"[", "p", "]"}], "]"}]}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"eql", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Left", " ", "Robin", " ", 
        RowBox[{"condition", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"lrbc", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"leftsign", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqlr", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"p", "=", "1"}], ",", 
           RowBox[{"p", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"leftsign", "=", 
             RowBox[{"-", "leftsign"}]}], ";", 
            RowBox[{"(*", " ", 
             RowBox[{
             "note", " ", "the", " ", "alternate", " ", "sign", " ", "for", 
              " ", "left", " ", "end", " ", "point", " ", "conditions"}], " ",
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"eqlr", "=", 
             RowBox[{"eqlr", "+", 
              RowBox[{"leftsign", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"lrbccoeffs", "*", 
                  RowBox[{"bc", "[", 
                   RowBox[{
                    RowBox[{"k", "+", "p", "-", "1"}], ",", "0"}], "]"}]}], 
                 "-", 
                 RowBox[{"lrbccoeffs", "*", 
                  RowBox[{"bc", "[", 
                   RowBox[{
                    RowBox[{"k", "+", "p", "-", "1"}], ",", "1"}], "]"}]}]}], 
                ")"}], "*", 
               RowBox[{"gamma", "[", 
                RowBox[{"[", "p", "]"}], "]"}]}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"eqlr", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Right", " ", "end", " ", 
        "point", " ", 
        RowBox[{"conditions", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "rbc", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"eqr", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"p", "=", "1"}], ",", 
           RowBox[{"p", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"eqr", "=", 
            RowBox[{"eqr", "+", 
             RowBox[{
              RowBox[{"bc", "[", 
               RowBox[{
                RowBox[{"k", "+", "p", "-", "1"}], ",", 
                RowBox[{"rbc", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "*", 
              RowBox[{"gamma", "[", 
               RowBox[{"[", "p", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"eqr", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Right", " ", "Robin", 
        " ", 
        RowBox[{"condition", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"rrbc", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"eqrr", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"p", "=", "1"}], ",", 
           RowBox[{"p", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"p", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"eqrr", "=", 
            RowBox[{"eqrr", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rrbccoeffs", "*", 
                 RowBox[{"bc", "[", 
                  RowBox[{
                   RowBox[{"k", "+", "p", "-", "1"}], ",", "0"}], "]"}]}], 
                "+", 
                RowBox[{"rrbccoeffs", "*", 
                 RowBox[{"bc", "[", 
                  RowBox[{
                   RowBox[{"k", "+", "p", "-", "1"}], ",", "1"}], "]"}]}]}], 
               ")"}], "*", 
              RowBox[{"gamma", "[", 
               RowBox[{"[", "p", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"eqrr", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Seperate", " ", "odd", " ", "and", " ", "even", " ", "modes", " ", 
        "since", " ", "they", " ", "decouple", " ", "when", " ", "midpoint", 
        " ", "or", " ", "integral", " ", "condition", " ", "is", " ", 
        RowBox[{"imposed", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mbc", "+", "intbc"}], ">", "0"}], ",", 
        RowBox[{
         RowBox[{"eqs2", "=", "eqs"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Middle", " ", "point", 
        " ", 
        RowBox[{"condition", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mbc", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"eqm", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqm2", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"odd", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"midsign", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"q", "=", "2"}], ",", 
           RowBox[{"q", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"q", "=", 
            RowBox[{"q", "+", "2"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"midsign", "=", 
             RowBox[{"-", "midsign"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eqm", "=", 
             RowBox[{"eqm", "+", 
              RowBox[{"midsign", "*", 
               RowBox[{"bcm", "[", 
                RowBox[{"k", "+", "q", "-", "1"}], "]"}], "*", 
               RowBox[{"gamma", "[", 
                RowBox[{"[", "q", "]"}], "]"}]}]}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"eqm", "\[Equal]", "0"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"even", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"midsign", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"q", "=", "1"}], ",", 
           RowBox[{"q", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"q", "=", 
            RowBox[{"q", "+", "2"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"midsign", "=", 
             RowBox[{"-", "midsign"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"eqm2", "=", 
             RowBox[{"eqm2", "+", 
              RowBox[{"midsign", "*", 
               RowBox[{"bcm", "[", 
                RowBox[{"k", "+", "q", "-", "1"}], "]"}], "*", 
               RowBox[{"gamma", "[", 
                RowBox[{"[", "q", "]"}], "]"}]}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs2", ",", 
           RowBox[{"eqm2", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"**", "**", "**", "**"}], "*", " ", "Integral", " ", 
        RowBox[{"condition", "."}]}], " ", "**********)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"intbc", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"eqint", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"eqint2", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"odd", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"q", "=", "2"}], ",", 
            RowBox[{"q", "\[LessEqual]", 
             RowBox[{"M", "+", "1"}]}], ",", 
            RowBox[{"q", "=", 
             RowBox[{"q", "+", "2"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"eqint", "=", 
              RowBox[{"eqint", "+", 
               RowBox[{
                RowBox[{"bcint", "[", 
                 RowBox[{"k", "+", "q", "-", "1"}], "]"}], "*", 
                RowBox[{"gamma", "[", 
                 RowBox[{"[", "q", "]"}], "]"}]}]}]}], ";"}]}], "]"}], " ", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"eqs", ",", 
            RowBox[{"eqint", "\[Equal]", "0"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"even", " ", "modes"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"q", "=", "1"}], ",", 
           RowBox[{"q", "\[LessEqual]", 
            RowBox[{"M", "+", "1"}]}], ",", 
           RowBox[{"q", "=", 
            RowBox[{"q", "+", "2"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"eqint2", "=", 
            RowBox[{"eqint2", "+", 
             RowBox[{
              RowBox[{"bcint", "[", 
               RowBox[{"k", "+", "q", "-", "1"}], "]"}], "*", 
              RowBox[{"gamma", "[", 
               RowBox[{"[", "q", "]"}], "]"}]}]}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs2", ",", 
           RowBox[{"eqint2", "\[Equal]", "0"}]}], "]"}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Set", " ", "the", " ", "last", " ", "parameter", " ", "as", " ", "1", 
        " ", "and", " ", "solve", " ", "the", " ", 
        RowBox[{"system", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"eqs", ",", 
        RowBox[{
         RowBox[{"gamma", "[", 
          RowBox[{"[", 
           RowBox[{"M", "+", "1"}], "]"}], "]"}], "\[Equal]", "1"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{"eqs", ",", "gamma"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Set", " ", "the", " ", "penultimate", " ", "parameter", " ", "as", 
        " ", "1", " ", "in", " ", "case", " ", "the", " ", "equations", " ", 
        "are", " ", 
        RowBox[{"unsolvable", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"sol", "===", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"eqs", "[", 
           RowBox[{"[", 
            RowBox[{"M", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"gamma", "[", 
            RowBox[{"[", "M", "]"}], "]"}], "\[Equal]", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sol", "=", 
          RowBox[{"Solve", "[", 
           RowBox[{"eqs", ",", "gamma"}], "]"}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Solve", " ", "eqs2", " ", "if", " ", 
        RowBox[{"necessary", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mbc", "+", "intbc"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"eqs2", ",", 
           RowBox[{
            RowBox[{"gamma", "[", 
             RowBox[{"[", 
              RowBox[{"M", "+", "1"}], "]"}], "]"}], "\[Equal]", "1"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sol2", "=", 
          RowBox[{"Solve", "[", 
           RowBox[{"eqs2", ",", "gamma"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Set", " ", "the", " ", "penultimate", " ", "parameter", " ", "as", 
           " ", "1", " ", "in", " ", "case", " ", "the", " ", "equations", 
           " ", "are", " ", "unsolvable"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"sol2", "===", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"eqs2", "[", 
              RowBox[{"[", 
               RowBox[{"M", "+", "1"}], "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"gamma", "[", 
               RowBox[{"[", "M", "]"}], "]"}], "\[Equal]", "1"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sol2", "=", 
             RowBox[{"Solve", "[", 
              RowBox[{"eqs2", ",", "gamma"}], "]"}]}], ";"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Return", " ", "both", " ", "solutions"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"sol", ",", "sol2"}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Otherwise", ",", 
          RowBox[{"return", " ", "only", " ", "sol"}]}], "*)"}], 
        "\[IndentingNewLine]", "sol"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Left", " ", "and", " ", "right", " ", "end", " ", "point", " ", 
    RowBox[{"conditions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Lists", " ", "of", " ", "the", " ", "orders", " ", "of", " ", "the", " ", 
    "boundary", " ", 
    RowBox[{"conditions", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lbc", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rbc", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Left", " ", "and", " ", "right", " ", "Robin", " ", 
    RowBox[{"conditions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "0", " ", "stands", " ", "for", " ", "false", " ", "and", " ", "1", " ", 
    "stands", " ", "for", " ", 
    RowBox[{"true", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lrbc", "=", "0"}], ";", 
   RowBox[{"lrbccoeffs", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"lrbccoeffs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "u", 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"lrbccoeffs", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"u", "'"}], 
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}]}]}], "=", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rrbc", "=", "0"}], ";", 
   RowBox[{"rrbccoeffs", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}]}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"rrbccoeffs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "*", "u", 
       RowBox[{"(", "1", ")"}]}], "+", 
      RowBox[{
       RowBox[{"rrbccoeffs", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "*", 
       RowBox[{"u", "'"}], 
       RowBox[{"(", "1", ")"}]}]}], "=", "0"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Middle", " ", "point", " ", "condition", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "only", " ", "first", " ", "order", " ", "is", " ", "supported"}], 
       ")"}], "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "0", " ", "stands", " ", "for", " ", "false", " ", "and", " ", "1", " ", 
     "stands", " ", "for", " ", 
     RowBox[{"true", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"mbc", "=", "0"}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Integral", " ", 
    RowBox[{"condition", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "0", " ", "stands", " ", "for", " ", "false", " ", "and", " ", "1", " ", 
    "stands", " ", "for", " ", 
    RowBox[{"true", "."}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intbc", "=", "0"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Underlying", " ", 
    RowBox[{"basis", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"\"\<C\>\"", " ", "for", " ", "Chebyshev"}], ",", " ", 
    RowBox[{"\"\<L\>\"", " ", "for", " ", "Legendre", " ", "and", " ", 
     RowBox[{"{", 
      RowBox[{"\"\<U\>\"", ",", " ", "alpha"}], "}"}], " ", "for", " ", 
     "ultraspherical", " ", "and", " ", "its", " ", "index", " ", "alpha"}]}],
    " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basis", "=", "\"\<C\>\""}], ";"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", "=", "\"\<L\>\""}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"basis", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<U\>\"", ",", "4"}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"For", " ", "printing"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"printsol", "=", "True"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"BasisRecombinationCoeffs", "[", 
     RowBox[{
     "lbc", ",", "rbc", ",", "lrbc", ",", "lrbccoeffs", ",", "rrbc", ",", 
      "rrbccoeffs", ",", "mbc", ",", "intbc", ",", "basis"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"printsol", "&&", 
    RowBox[{"sol", "=!=", "$Failed"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Coefficients for each k:\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"mbc", "+", "intbc"}], ">", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"solOdd", ",", "solEven"}], "}"}], "=", "sol"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<odd k:\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"solOdd", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Subsuperscript", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"j", "-", "1"}], ",", "\"\<k\>\""}], "]"}], "\[Rule]", 
           RowBox[{"Factor", "[", 
            RowBox[{"solOdd", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}], "]"}]}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "\"\<even k:\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"solEven", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Subsuperscript", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"j", "-", "1"}], ",", "\"\<k\>\""}], "]"}], "\[Rule]", 
           RowBox[{"Factor", "[", 
            RowBox[{"solEven", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}], "]"}]}], 
          "]"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"sol", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
           RowBox[{"Subsuperscript", "[", 
            RowBox[{"\[Gamma]", ",", 
             RowBox[{"j", "-", "1"}], ",", "\"\<k\>\""}], "]"}], "\[Rule]", 
           RowBox[{"Factor", "[", 
            RowBox[{"sol", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}], "]"}]}], 
          "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdy11IU3EYBvBDWqjJZoqOimmp5CTX7BDDppJufow1TJQxsCBYaRS0XWQ1
qC4y6DgHEQ5vpOWWFsiGjlaSmx+j/GCjBCciDWNXsQzOtlbGNsbqPP+Llx88
z/Oe1Bl6+g9QFFXNHbyw92bv7Sjb6rhf9wua7Q9SMCGSpmH7evCgm1PqrjkE
XSbtYchTNRyBI/+sMijU3VTA3+3iTtJbWSVckVg0cPnuD+J+7mYf7FKeN8Kh
XuoJ9JrUDMyV5o1BeYWQ6HqltsNvHf5p2OYxe2Ao5wPxdMDgg49fRD9Cpyru
J3/9l77AzMOiIAwPPPoKb+90J6ExeyVNdsEs9Y5z1ankQYHPWgyDf8dLYOjq
rAAW7YtrYCpjE8P52BwDB8tHzfAnvUXcYAqi8KW3MQa3vTeo95xrs7U8GGdf
F0PH8OJReN3CnoCBO59PQc/g9lmSD+loOHfxcjMsa5ogJu9F5PDZTlgJbYWM
Bt6SPe2DfGc+vcLJTE0q4B87rYXV4mPXYFfVd4fHwraeeV7qhOeO6z/BqChG
XIi7K72cMy0RIj8dkcBCmaAeLukT9bucrt0GGv4H5GFCbQ==
  "],
 CellLabel->
  "(\:8c03\:8bd5) \
In[1]:=",ExpressionUUID->"6bc3a7ee-332d-4dc2-af4b-90125101501c"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Coefficients for each k:\"\>"], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110803967`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"9a3391c0-7720-4f8d-98d1-\
02a1999c6f3f"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","0","\"k\""},
   "Subsuperscript"], "\[Rule]", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"6", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"7", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"8", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"9", "+", "k"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", "k"}], ")"}]}]]}]}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110892267`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"420a213f-4862-4832-bf2b-\
920bfb73fb94"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","1","\"k\""},
   "Subsuperscript"], "\[Rule]", "0"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110892267`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"38df4bb9-6fc5-4547-8738-\
3688c89485e9"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","2","\"k\""},
   "Subsuperscript"], "\[Rule]", 
  FractionBox[
   RowBox[{"5", " ", 
    RowBox[{"(", 
     RowBox[{"7", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"8", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"9", "+", "k"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"4", "+", "k"}], ")"}]}]]}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110930247`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"93e56279-9d66-40d2-9cea-\
6e77933995c9"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","3","\"k\""},
   "Subsuperscript"], "\[Rule]", "0"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110937185`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"0d9aebaf-5f9d-4a45-a7f1-\
314cf9548719"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","4","\"k\""},
   "Subsuperscript"], "\[Rule]", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"10", " ", 
     RowBox[{"(", 
      RowBox[{"8", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"9", "+", "k"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", "k"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", "k"}], ")"}]}]]}]}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110958796`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"a03c5181-deae-4250-85bc-\
646e4fef1214"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","5","\"k\""},
   "Subsuperscript"], "\[Rule]", "0"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110968904`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"0871f1cb-b662-4ff1-8886-\
f132a3b0963d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","6","\"k\""},
   "Subsuperscript"], "\[Rule]", 
  FractionBox[
   RowBox[{"10", " ", 
    RowBox[{"(", 
     RowBox[{"6", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"9", "+", "k"}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3", "+", "k"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"4", "+", "k"}], ")"}]}]]}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.9698354110996447`*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"08f256d3-356e-4ee4-8a28-\
e6aa8f53739d"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","7","\"k\""},
   "Subsuperscript"], "\[Rule]", "0"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.969835411100709*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"7d714040-5a0e-4d51-91c0-\
fb39e4a8a184"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","8","\"k\""},
   "Subsuperscript"], "\[Rule]", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"5", " ", 
     RowBox[{"(", 
      RowBox[{"8", "+", "k"}], ")"}]}], 
    RowBox[{"4", "+", "k"}]]}]}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.969835411100709*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"c3658d8a-adcc-40cd-bfd1-\
8783e7294458"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","9","\"k\""},
   "Subsuperscript"], "\[Rule]", "0"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.969835411103932*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"e1f353a1-60b6-4340-b9df-\
01d4c0c005d7"],

Cell[BoxData[
 RowBox[{
  TemplateBox[{"\[Gamma]","10","\"k\""},
   "Subsuperscript"], "\[Rule]", "1"}]], "Print",
 CellChangeTimes->{
  3.969228492371375*^9, 3.9692287584065156`*^9, {3.969228822789972*^9, 
   3.9692288619868217`*^9}, {3.969228894967249*^9, 3.9692289152210426`*^9}, 
   3.969228959179366*^9, 3.969229078505303*^9, {3.969229332433611*^9, 
   3.9692293557071514`*^9}, {3.969229414746812*^9, 3.9692294679683185`*^9}, {
   3.969229501640086*^9, 3.969229547156068*^9}, {3.9692297725138083`*^9, 
   3.969229798442151*^9}, {3.9692298313939314`*^9, 3.969229886914592*^9}, 
   3.9692299204606285`*^9, {3.9692309928486085`*^9, 3.969231023420585*^9}, 
   3.9692310577995663`*^9, {3.969231114631015*^9, 3.9692311518432045`*^9}, {
   3.9692312365472965`*^9, 3.96923125290355*^9}, 3.9692313418581505`*^9, {
   3.9692313851689405`*^9, 3.9692314187551656`*^9}, {3.9692315352027283`*^9, 
   3.969231573092591*^9}, {3.969261993663026*^9, 3.969262109897817*^9}, 
   3.969262243702853*^9, 3.969262361665174*^9, 3.969766753951251*^9, 
   3.969766945574685*^9, 3.9697677042949305`*^9, 3.969767809654629*^9, 
   3.969835411103932*^9},
 CellLabel->
  "(\:8c03\:8bd5) \
\:6b63\:5728\:8ba1\:7b97In[1]:=",ExpressionUUID->"ef1670e1-d081-4276-8651-\
8bc17d3d959a"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1484, 941},
WindowMargins->{{Automatic, -1402}, {Automatic, 12}},
Magnification:>1.4 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (2019\:5e744\:67088\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 34766, 863, 5905, "Input",ExpressionUUID->"6bc3a7ee-332d-4dc2-af4b-90125101501c"],
Cell[CellGroupData[{
Cell[35371, 889, 1198, 19, 32, "Print",ExpressionUUID->"9a3391c0-7720-4f8d-98d1-02a1999c6f3f"],
Cell[36572, 910, 1807, 42, 56, "Print",ExpressionUUID->"420a213f-4862-4832-bf2b-920bfb73fb94"],
Cell[38382, 954, 1253, 22, 36, "Print",ExpressionUUID->"38df4bb9-6fc5-4547-8738-3688c89485e9"],
Cell[39638, 978, 1658, 37, 56, "Print",ExpressionUUID->"93e56279-9d66-40d2-9cea-6e77933995c9"],
Cell[41299, 1017, 1253, 22, 36, "Print",ExpressionUUID->"0d9aebaf-5f9d-4a45-a7f1-314cf9548719"],
Cell[42555, 1041, 1566, 34, 56, "Print",ExpressionUUID->"a03c5181-deae-4250-85bc-646e4fef1214"],
Cell[44124, 1077, 1253, 22, 36, "Print",ExpressionUUID->"0871f1cb-b662-4ff1-8886-f132a3b0963d"],
Cell[45380, 1101, 1537, 33, 56, "Print",ExpressionUUID->"08f256d3-356e-4ee4-8a28-e6aa8f53739d"],
Cell[46920, 1136, 1251, 22, 36, "Print",ExpressionUUID->"7d714040-5a0e-4d51-91c0-fb39e4a8a184"],
Cell[48174, 1160, 1394, 28, 52, "Print",ExpressionUUID->"c3658d8a-adcc-40cd-bfd1-8783e7294458"],
Cell[49571, 1190, 1251, 22, 36, "Print",ExpressionUUID->"e1f353a1-60b6-4340-b9df-01d4c0c005d7"],
Cell[50825, 1214, 1252, 22, 36, "Print",ExpressionUUID->"ef1670e1-d081-4276-8651-8bc17d3d959a"]
}, Open  ]]
}, Open  ]]
}
]
*)

